# DS

### Цель проекта: разработка решения, которое автоматизирует процесс сопоставления товаров заказчика с размещаемыми товарами дилеров.

✏️**Распределение задач:**

**Евгений:** предобработка данных, разработка решения методом ближайших соседей с классификатором KNN, создание скрипта\
**Дарья:** предобработка данных, разработка решения методом ближайших соседей с CatBoost\

:book: **Описание данных:**
>*marketing_dealerprice:* парсинг сайтов дилеров\
*marketing_product:* продукты компании Prosept\
*marketing_productdealerkey:* матчинг товаров заказчика и дилеров

**В процессе работы над проектом:**
1. Были исследованы предоставленные данные, выбраны подходы к решению задачи.
2. Проведена предобработка данных. Созданы функции очистки, лематизации и эмбеддинга названий продуктов базы Prosept и запросов дилеров.
3. Реализованы 3 подхода к решению задачи автоматизации сопоставления товаров.
4. Разработана MVP модель KNN (precision@5=0,84)
5. Оформлен скрипт

**Метрика качества:** precision@5

**Инструкция:**
1. Изменить путь для датасета на подходящий в функции load_data в [файле](https://github.com/Prosept-marking/DS/blob/main/preprocess.py)
2. Установить зависимости: pip install -r requirements.txt
3. На вход модели подается заголовок товара (как в парсинг-файле). Пример: "Средство универсальное Prosept Universal Spray, 500мл"
4. На выход модель выдаёт список из 5 id, которые указывают на товар в базе производителя.

**Описание работы скрипта:**\
На вход поступают база данных продуктов Prosept и запрос из базы дилеров.\
Данные проходят предобработку: 
- выбираются колонки с нужными данными:\
  бд дилеров: product_name\
  бд продуктов: name, id
- пустые значения колонки name заменяется словом “unknown”, чтобы в работе кода не было ошибок
- наименованиям товаров из бд продуктов и запроса от дилеров создаются эмбеддинги, т.е. их векторное представление

Предобработка продуктов бд сохраняется и в последующих запросах её не придётся обрабатывать заново.

Загружается предобученная модель NearestNeighbors с гиперпараметрами:
- количество соседей (n_neighbors) = 5
- метрика сходства (metric) = cosine (косинусное расстояние)\
При помощи встроенного метода kneighbors нашей модели, вычисляем для запроса дилеров по 5 ближайших соседей из базы производителя.\
На выходе получаем 5 id самых подходящих продуктов.

Для проверки качества модели мы выбрали метрику precision@5. На тестовых данных она составила 0.9.\
Это означает, что для 90% запросов модель выдала такие 5 ближайших соседей, среди которых оказался верный.
